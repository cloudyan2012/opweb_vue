import{j as Pe,k as re,N as Oe,l as Fe,m as Re,U as K,p as O,I as Y,C as me,q as Z,s as J,v as Me,x as Ke,r as b,y as qe,c as F,z as ze,A as be,o as Q,d as x,a as X,w as C,h as ue,n as R,B as p,D as ie,e as _,g as A,E as I,G as Ue,H as We,F as he,J as He,i as ye,t as je,K as Ge,L as N,M as ce,O as Ye,P as Ze,Q as Je,R as G,S as Qe,T as Xe,V as et,W as tt,X as ee,Y as at,Z as V,$ as _e,a0 as st,a1 as lt,a2 as z,a3 as ot,a4 as we,a5 as P,a6 as de,a7 as nt,a8 as rt,_ as te,a9 as ut,aa as pe,b as fe}from"./index-DTFrLyAg.js";import{E as it}from"./el-text-DfYvO63T.js";import{e as ct,E as dt}from"./echarts-CpuL25-8.js";import{u as pt,E as ft}from"./el-input-xBZE2S8A.js";import{d as vt,b as gt,a as mt,E as bt}from"./el-tag-DGG6BfxF.js";import{u as ht}from"./use-form-item-DK04pkf6.js";const yt=Pe({valueKey:{type:String,default:"value"},modelValue:{type:[String,Number],default:""},debounce:{type:Number,default:300},placement:{type:re(String),values:["top","top-start","top-end","bottom","bottom-start","bottom-end"],default:"bottom-start"},fetchSuggestions:{type:re([Function,Array]),default:Oe},popperClass:{type:String,default:""},triggerOnFocus:{type:Boolean,default:!0},selectWhenUnmatched:{type:Boolean,default:!1},hideLoading:{type:Boolean,default:!1},teleported:Fe.teleported,highlightFirstItem:{type:Boolean,default:!1},fitInputWidth:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},name:String,...Re(["ariaLabel"])}),_t={[K]:t=>O(t),[Y]:t=>O(t),[me]:t=>O(t),focus:t=>t instanceof FocusEvent,blur:t=>t instanceof FocusEvent,clear:()=>!0,select:t=>Z(t)},Ce="ElAutocomplete",wt=J({name:Ce,inheritAttrs:!1}),Ct=J({...wt,props:yt,emits:_t,setup(t,{expose:e,emit:s}){const a=t,i=pt(),n=Me(),c=ht(),o=Ke("autocomplete"),u=b(),v=b(),d=b(),h=b();let r=!1,y=!1;const f=b([]),g=b(-1),T=b(""),$=b(!1),S=b(!1),L=b(!1),D=qe(),$e=F(()=>n.style),E=F(()=>(f.value.length>0||L.value)&&$.value),ae=F(()=>!a.hideLoading&&L.value),xe=F(()=>u.value?Array.from(u.value.$el.querySelectorAll("input")):[]),Ee=()=>{E.value&&(T.value=`${u.value.$el.offsetWidth}px`)},Ae=()=>{g.value=-1},se=vt(async l=>{if(S.value)return;const m=w=>{L.value=!1,!S.value&&(G(w)?(f.value=w,g.value=a.highlightFirstItem?0:-1):Qe(Ce,"autocomplete suggestions must be an array"))};if(L.value=!0,G(a.fetchSuggestions))m(a.fetchSuggestions);else{const w=await a.fetchSuggestions(l,m);G(w)&&m(w)}},a.debounce),Se=l=>{const m=!!l;if(s(Y,l),s(K,l),S.value=!1,$.value||($.value=m),!a.triggerOnFocus&&!l){S.value=!0,f.value=[];return}se(l)},Le=l=>{var m;c.value||(((m=l.target)==null?void 0:m.tagName)!=="INPUT"||xe.value.includes(document.activeElement))&&($.value=!0)},ke=l=>{s(me,l)},Ie=l=>{y?y=!1:($.value=!0,s("focus",l),a.triggerOnFocus&&!r&&se(String(a.modelValue)))},Te=l=>{setTimeout(()=>{var m;if((m=d.value)!=null&&m.isFocusInsideContent()){y=!0;return}$.value&&B(),s("blur",l)})},De=()=>{$.value=!1,s(K,""),s("clear")},le=async()=>{E.value&&g.value>=0&&g.value<f.value.length?U(f.value[g.value]):a.selectWhenUnmatched&&(s("select",{value:a.modelValue}),f.value=[],g.value=-1)},Be=l=>{E.value&&(l.preventDefault(),l.stopPropagation(),B())},B=()=>{$.value=!1},Ne=()=>{var l;(l=u.value)==null||l.focus()},Ve=()=>{var l;(l=u.value)==null||l.blur()},U=async l=>{s(Y,l[a.valueKey]),s(K,l[a.valueKey]),s("select",l),f.value=[],g.value=-1},W=l=>{if(!E.value||L.value)return;if(l<0){g.value=-1;return}l>=f.value.length&&(l=f.value.length-1);const m=v.value.querySelector(`.${o.be("suggestion","wrap")}`),k=m.querySelectorAll(`.${o.be("suggestion","list")} li`)[l],H=m.scrollTop,{offsetTop:ne,scrollHeight:j}=k;ne+j>H+m.clientHeight&&(m.scrollTop+=j),ne<H&&(m.scrollTop-=j),g.value=l,u.value.ref.setAttribute("aria-activedescendant",`${D.value}-item-${g.value}`)},oe=ze(h,()=>{E.value&&B()});return be(()=>{oe==null||oe()}),Q(()=>{u.value.ref.setAttribute("role","textbox"),u.value.ref.setAttribute("aria-autocomplete","list"),u.value.ref.setAttribute("aria-controls","id"),u.value.ref.setAttribute("aria-activedescendant",`${D.value}-item-${g.value}`),r=u.value.ref.hasAttribute("readonly")}),e({highlightedIndex:g,activated:$,loading:L,inputRef:u,popperRef:d,suggestions:f,handleSelect:U,handleKeyEnter:le,focus:Ne,blur:Ve,close:B,highlight:W}),(l,m)=>(x(),X(p(Ze),{ref_key:"popperRef",ref:d,visible:p(E),placement:l.placement,"fallback-placements":["bottom-start","top-start"],"popper-class":[p(o).e("popper"),l.popperClass],teleported:l.teleported,"gpu-acceleration":!1,pure:"","manual-mode":"",effect:"light",trigger:"click",transition:`${p(o).namespace.value}-zoom-in-top`,persistent:"",role:"listbox",onBeforeShow:Ee,onHide:Ae},{content:C(()=>[ue("div",{ref_key:"regionRef",ref:v,class:R([p(o).b("suggestion"),p(o).is("loading",p(ae))]),style:ie({[l.fitInputWidth?"width":"minWidth"]:T.value,outline:"none"}),role:"region"},[_(p(gt),{id:p(D),tag:"ul","wrap-class":p(o).be("suggestion","wrap"),"view-class":p(o).be("suggestion","list"),role:"listbox"},{default:C(()=>[p(ae)?(x(),A("li",{key:0},[I(l.$slots,"loading",{},()=>[_(p(Ue),{class:R(p(o).is("loading"))},{default:C(()=>[_(p(We))]),_:1},8,["class"])])])):(x(!0),A(he,{key:1},He(f.value,(w,k)=>(x(),A("li",{id:`${p(D)}-item-${k}`,key:k,class:R({highlighted:g.value===k}),role:"option","aria-selected":g.value===k,onClick:H=>U(w)},[I(l.$slots,"default",{item:w},()=>[ye(je(w[l.valueKey]),1)])],10,["id","aria-selected","onClick"]))),128))]),_:3},8,["id","wrap-class","view-class"])],6)]),default:C(()=>[ue("div",{ref_key:"listboxRef",ref:h,class:R([p(o).b(),l.$attrs.class]),style:ie(p($e)),role:"combobox","aria-haspopup":"listbox","aria-expanded":p(E),"aria-owns":p(D)},[_(p(ft),Ge({ref_key:"inputRef",ref:u},p(i),{clearable:l.clearable,disabled:p(c),name:l.name,"model-value":l.modelValue,"aria-label":l.ariaLabel,onInput:Se,onChange:ke,onFocus:Ie,onBlur:Te,onClear:De,onKeydown:[N(ce(w=>W(g.value-1),["prevent"]),["up"]),N(ce(w=>W(g.value+1),["prevent"]),["down"]),N(le,["enter"]),N(B,["tab"]),N(Be,["esc"])],onMousedown:Le}),Ye({_:2},[l.$slots.prepend?{name:"prepend",fn:C(()=>[I(l.$slots,"prepend")])}:void 0,l.$slots.append?{name:"append",fn:C(()=>[I(l.$slots,"append")])}:void 0,l.$slots.prefix?{name:"prefix",fn:C(()=>[I(l.$slots,"prefix")])}:void 0,l.$slots.suffix?{name:"suffix",fn:C(()=>[I(l.$slots,"suffix")])}:void 0]),1040,["clearable","disabled","name","model-value","aria-label","onKeydown"])],14,["aria-expanded","aria-owns"])]),_:3},8,["visible","placement","popper-class","teleported","transition"]))}});var $t=Je(Ct,[["__file","autocomplete.vue"]]);const xt=Xe($t);function Et(t){let e;const s=b(!1),a=et({...t,originalPosition:"",originalOverflow:"",visible:!1});function i(r){a.text=r}function n(){const r=a.parent,y=h.ns;if(!r.vLoadingAddClassList){let f=r.getAttribute("loading-number");f=Number.parseInt(f)-1,f?r.setAttribute("loading-number",f.toString()):(z(r,y.bm("parent","relative")),r.removeAttribute("loading-number")),z(r,y.bm("parent","hidden"))}c(),d.unmount()}function c(){var r,y;(y=(r=h.$el)==null?void 0:r.parentNode)==null||y.removeChild(h.$el)}function o(){var r;t.beforeClose&&!t.beforeClose()||(s.value=!0,clearTimeout(e),e=setTimeout(u,400),a.visible=!1,(r=t.closed)==null||r.call(t))}function u(){if(!s.value)return;const r=a.parent;s.value=!1,r.vLoadingAddClassList=void 0,n()}const v=J({name:"ElLoading",setup(r,{expose:y}){const{ns:f,zIndex:g}=at("loading");return y({ns:f,zIndex:g}),()=>{const T=a.spinner||a.svg,$=V("svg",{class:"circular",viewBox:a.svgViewBox?a.svgViewBox:"0 0 50 50",...T?{innerHTML:T}:{}},[V("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),S=a.text?V("p",{class:f.b("text")},[a.text]):void 0;return V(lt,{name:f.b("fade"),onAfterLeave:u},{default:C(()=>[_e(_("div",{style:{backgroundColor:a.background||""},class:[f.b("mask"),a.customClass,a.fullscreen?"is-fullscreen":""]},[V("div",{class:f.b("spinner")},[$,S])]),[[st,a.visible]])])})}}}),d=tt(v),h=d.mount(document.createElement("div"));return{...ee(a),setText:i,removeElLoadingChild:c,close:o,handleAfterLeave:u,vm:h,get $el(){return h.$el}}}let M;const At=function(t={}){if(!ot)return;const e=St(t);if(e.fullscreen&&M)return M;const s=Et({...e,closed:()=>{var i;(i=e.closed)==null||i.call(e),e.fullscreen&&(M=void 0)}});Lt(e,e.parent,s),ve(e,e.parent,s),e.parent.vLoadingAddClassList=()=>ve(e,e.parent,s);let a=e.parent.getAttribute("loading-number");return a?a=`${Number.parseInt(a)+1}`:a="1",e.parent.setAttribute("loading-number",a),e.parent.appendChild(s.$el),we(()=>s.visible.value=e.visible),e.fullscreen&&(M=s),s},St=t=>{var e,s,a,i;let n;return O(t.target)?n=(e=document.querySelector(t.target))!=null?e:document.body:n=t.target||document.body,{parent:n===document.body||t.body?document.body:n,background:t.background||"",svg:t.svg||"",svgViewBox:t.svgViewBox||"",spinner:t.spinner||!1,text:t.text||"",fullscreen:n===document.body&&((s=t.fullscreen)!=null?s:!0),lock:(a=t.lock)!=null?a:!1,customClass:t.customClass||"",visible:(i=t.visible)!=null?i:!0,beforeClose:t.beforeClose,closed:t.closed,target:n}},Lt=async(t,e,s)=>{const{nextZIndex:a}=s.vm.zIndex||s.vm._.exposed.zIndex,i={};if(t.fullscreen)s.originalPosition.value=P(document.body,"position"),s.originalOverflow.value=P(document.body,"overflow"),i.zIndex=a();else if(t.parent===document.body){s.originalPosition.value=P(document.body,"position"),await we();for(const n of["top","left"]){const c=n==="top"?"scrollTop":"scrollLeft";i[n]=`${t.target.getBoundingClientRect()[n]+document.body[c]+document.documentElement[c]-Number.parseInt(P(document.body,`margin-${n}`),10)}px`}for(const n of["height","width"])i[n]=`${t.target.getBoundingClientRect()[n]}px`}else s.originalPosition.value=P(e,"position");for(const[n,c]of Object.entries(i))s.$el.style[n]=c},ve=(t,e,s)=>{const a=s.vm.ns||s.vm._.exposed.ns;["absolute","fixed","sticky"].includes(s.originalPosition.value)?z(e,a.bm("parent","relative")):de(e,a.bm("parent","relative")),t.fullscreen&&t.lock?de(e,a.bm("parent","hidden")):z(e,a.bm("parent","hidden"))},q=Symbol("ElLoading"),ge=(t,e)=>{var s,a,i,n;const c=e.instance,o=r=>Z(e.value)?e.value[r]:void 0,u=r=>{const y=O(r)&&(c==null?void 0:c[r])||r;return y&&b(y)},v=r=>u(o(r)||t.getAttribute(`element-loading-${rt(r)}`)),d=(s=o("fullscreen"))!=null?s:e.modifiers.fullscreen,h={text:v("text"),svg:v("svg"),svgViewBox:v("svgViewBox"),spinner:v("spinner"),background:v("background"),customClass:v("customClass"),fullscreen:d,target:(a=o("target"))!=null?a:d?void 0:t,body:(i=o("body"))!=null?i:e.modifiers.body,lock:(n=o("lock"))!=null?n:e.modifiers.lock};t[q]={options:h,instance:At(h)}},kt=(t,e)=>{for(const s of Object.keys(e))nt(e[s])&&(e[s].value=t[s])},It={mounted(t,e){e.value&&ge(t,e)},updated(t,e){const s=t[q];e.oldValue!==e.value&&(e.value&&!e.oldValue?ge(t,e):e.value&&e.oldValue?Z(e.value)&&kt(e.value,s.options):s==null||s.instance.close())},unmounted(t){var e;(e=t[q])==null||e.instance.close(),t[q]=null}},Tt={props:{tableData:{type:Array,Required:!0}},setup(t){const{tableData:e}=ee(t);return{tableData:e}}};function Dt(t,e,s,a,i,n){const c=mt,o=bt;return x(),X(o,{data:a.tableData,stripe:"",height:"220"},{default:C(()=>[_(c,{prop:"ExamDate",label:"Date"}),_(c,{prop:"Chinese",label:"语文"}),_(c,{prop:"Mathematics",label:"数学"}),_(c,{prop:"English",label:"英语"})]),_:1},8,["data"])}const Bt=te(Tt,[["render",Dt]]),Nt={props:{tableData:{type:Array,required:!0}},setup(t){const e=b(null),{tableData:s}=ee(t);let a=null;const i=()=>{const n=[],c=[],o=[],u=[];s.value.forEach(d=>{n.push(d.ExamDate),c.push(d.Chinese),o.push(d.Mathematics),u.push(d.English)});const v={legend:{data:["语文","数学","英语"]},grid:{left:"1%",right:"1%",bottom:"3%",top:"10%",containLabel:!0},xAxis:{type:"category",data:n},yAxis:{type:"value",minInterval:5,min:"dataMin"},series:[{name:"语文",type:"line",smooth:!0,data:c},{name:"数学",type:"line",smooth:!0,data:o},{name:"英语",type:"line",smooth:!0,data:u}]};a||(a=ct.init(e.value)),a.setOption(v)};return Q(()=>{i()}),be(()=>{a&&a.dispose()}),ut(s,n=>{i()}),{chartDom:e}}},Vt={ref:"chartDom",style:{width:"100%",height:"270px"}};function Pt(t,e,s,a,i,n){return x(),A("div",Vt,null,512)}const Ot=te(Nt,[["render",Pt]]),Ft={components:{tablereport:Bt,chartreport:Ot},setup(){const t=b(!0),e=b([]),s=b([]),a=b(""),i=async()=>{try{const o=await fe.get("/user");Array.isArray(o)?s.value=o:console.warn("返回的数据格式不正确。")}catch(o){console.error("获取用户列表失败:",o),alert("获取用户失败，请检查网络或稍后再试。")}},n=(o,u)=>{const v=o?s.value.filter(d=>d.uname.toLowerCase().indexOf(o.toLowerCase())!==-1):s.value;u(v)},c=async o=>{var u,v;if(t.value=!0,!(o!=null&&o.uname)){alert("无效的选择，请重新选择。");return}try{const d=await fe.get(`/exam?user=${o.uid}`);e.value=d.data&&Array.isArray(d.data)?d.data:[],t.value=!1}catch(d){const h=((v=(u=d.response)==null?void 0:u.data)==null?void 0:v.message)||d.message||"未知错误";alert(`获取数据失败: ${h}，请稍后再试。`)}};return Q(i),{loading:t,reportList:e,state:a,querySearchAsync:n,handleSelect:c}}},Rt={key:0},Mt={key:1,style:{"text-align":"center"}};function Kt(t,e,s,a,i,n){const c=xt,o=pe("tablereport"),u=pe("chartreport"),v=dt,d=it,h=It;return x(),A(he,null,[_(c,{modelValue:a.state,"onUpdate:modelValue":e[0]||(e[0]=r=>a.state=r),"value-key":"uname","fetch-suggestions":a.querySearchAsync,placeholder:"点击选择或直接输入姓名查询成绩",onSelect:a.handleSelect,style:{"min-width":"300px","max-width":"300px"}},null,8,["modelValue","fetch-suggestions","onSelect"]),a.reportList&&a.reportList.length?(x(),A("div",Rt,[_e((x(),X(v,{direction:"vertical",size:"large",fill:"",style:{"min-width":"99%"}},{default:C(()=>[_(o,{tableData:a.reportList},null,8,["tableData"]),_(u,{tableData:a.reportList},null,8,["tableData"])]),_:1})),[[h,a.loading]])])):(x(),A("div",Mt,[_(d,null,{default:C(()=>e[1]||(e[1]=[ye("暂无数据")])),_:1})]))],64)}const Yt=te(Ft,[["render",Kt]]);export{Yt as default};
